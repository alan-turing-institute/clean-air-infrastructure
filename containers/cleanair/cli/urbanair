#!/usr/bin/env python
import typer
from cleanair.parsers.urbanair_parser import inputs
from cleanair.parsers.urbanair_parser import features

app = typer.Typer()
state = {"verbose": False, "secretfile": ""}


@app.callback()
def main(
    verbose: bool = False,
    secretfile: str = typer.Option("", help="json file containing database secrets"),
) -> None:
    """
    Manage the CleanAir infrastructure
    """

    state["secretfile"] = secretfile

    if verbose:
        typer.echo("Will write verbose output")
        state["verbose"] = True


app.add_typer(inputs.app, name="inputs")
app.add_typer(features.app, name="features")

if __name__ == "__main__":

    app()
